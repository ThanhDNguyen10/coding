USE tnguy22;

CREATE TABLE tnguy22_STORE
(STORE_CODE INT PRIMARY KEY,
STORE_NAME VARCHAR(45),
STORE_LOC VARCHAR(45),
STORE_TYPE VARCHAR(45) );

DESCRIBE tnguy22_STORE;

INSERT INTO tnguy22_STORE
VALUES
(1232424, "Costco", "Manassas, VA 20109", "Wholesale");
INSERT INTO tnguy22_STORE
VALUES
(346235, "Walmart", "Alexandria, VA 22315", "Retail");
INSERT INTO tnguy22_STORE
VALUES
(1204945, "H Mart", "Centreville, VA 20121", "Supermarket");
INSERT INTO tnguy22_STORE
VALUES
(98435, "Walgreens", "Arlington, VA 22202", "Drugstore");
SELECT*FROM tnguy22_STORE;

CREATE TABLE tnguy22_ORDER
(ORDER_NUM INT PRIMARY KEY,
ORDER_STATUS VARCHAR(45),
STORE_CODE INT,
ORDER_DATE DATE,
FOREIGN KEY (STORE_CODE) REFERENCES tnguy22_STORE (STORE_CODE) );

DESCRIBE tnguy22_ORDER;

INSERT INTO tnguy22_ORDER
VALUES
(567765, "Pending", 98435, '2009-11-05');
INSERT INTO tnguy22_ORDER
VALUES
(577899, "Shipping", 98435, '2000-10-10');
INSERT INTO tnguy22_ORDER
VALUES
(112980, "Cancelled", 346235, '2019-01-05');
INSERT INTO tnguy22_ORDER
VALUES
(33491, "Pending", 98435, '2000-01-10');

SELECT*FROM tnguy22_ORDER;

CREATE TABLE tnguy22_ORDER_LINE
(ORDER_NUM INT PRIMARY KEY,
NUM_ORDERED INT,
ORDER_PRICE DECIMAL(6,2),
ORDER_DISCOUNT DECIMAL(3,2),
PROD_ID INT,
FOREIGN KEY (ORDER_NUM) REFERENCES tnguy22_ORDER (ORDER_NUM), 
FOREIGN KEY (PROD_ID) REFERENCES tnguy22_PRODUCT (PROD_ID));
DESCRIBE tnguy22_ORDER_LINE;

INSERT INTO tnguy22_ORDER_LINE
VALUES
(33491, 5, 85.99, 5.15, 222);
INSERT INTO tnguy22_ORDER_LINE
VALUES
(112980, 1, 15.49, 0.00, 222);
INSERT INTO tnguy22_ORDER_LINE
VALUES
(577899, 10, 129.59, 9.00, 98);
INSERT INTO tnguy22_ORDER_LINE
VALUES
(567765, 2, 29.59, 5.00, 535);

SELECT*FROM tnguy22_ORDER_LINE;

CREATE TABLE tnguy22_PRODUCT
(PROD_ID INT PRIMARY KEY,
PROD_QUANTITY INT,
PROD_PRICE DECIMAL(6,2),
DESCRIPTION CHAR(15) );

DESCRIBE tnguy22_PRODUCT;
INSERT INTO tnguy22_PRODUCT
VALUES
(535, 2000, 3.79, "Carrot");
INSERT INTO tnguy22_PRODUCT
VALUES
(152, 110, 4.49, "Cereal");
INSERT INTO tnguy22_PRODUCT
VALUES
(222, 100, 14.99, "Tylenol");
INSERT INTO tnguy22_PRODUCT
VALUES
(98, 50, 7.49, "Tshirt");
SELECT*FROM tnguy22_PRODUCT;

CREATE TABLE EMPLOYEE
(EMP_ID INT PRIMARY KEY,
EMP_HIRED_DATE DATE,
EMP_ADDRESS VARCHAR(45),
STORE_CODE INT,
EMP_LNAME VARCHAR(45),
EMP_FNAME VARCHAR(45),
FOREIGN KEY (STORE_CODE) REFERENCES tnguy22_STORE (STORE_CODE) );
DESCRIBE EMPLOYEE;

INSERT INTO EMPLOYEE
VALUES
(113123, '1999-01-02', "Fairfax, VA 22030", 1204945, "Smith", "John");
INSERT INTO EMPLOYEE
VALUES
(93823, '1989-11-06', "Fairfax, VA 22032", 98435, "Dan", "Alexander");
INSERT INTO EMPLOYEE
VALUES
(571406, '2016-07-29', "Manassas, VA 20109", 1232424, "Nguyen", "Thanh");
INSERT INTO EMPLOYEE
VALUES
(23426, '2016-03-11', "Manassas, VA 20109", 1232424, "Becky", "Browns");
SELECT*FROM EMPLOYEE;

CREATE TABLE DEPENDENT
(DEP_ID INT PRIMARY KEY,
DEP_FNAME VARCHAR(45),
DEP_LNAME VARCHAR(45),
EMP_ID INT,
DEP_AGE DATE,
FOREIGN KEY (EMP_ID) REFERENCES EMPLOYEE (EMP_ID) );

DESCRIBE DEPENDENT;

INSERT INTO DEPENDENT
VALUES
(5626, "Ashe", "Smith", 113123, 10);
INSERT INTO DEPENDENT
VALUES
(1126, "John", "Smith", 113123, 14);
INSERT INTO DEPENDENT
VALUES
(5866, "Cici", "Smith", 113123, 5);
INSERT INTO DEPENDENT
VALUES
(2344, "Wilson", "Dan", 93823, 9);
SELECT*FROM DEPENDENT;

SELECT tnguy22_ORDER_LINE.ORDER_NUM, (NUM_ORDERED*ORDER_DISCOUNT) AS 'TOTAL' FROM tnguy22_ORDER_LINE, tnguy22_ORDER 
WHERE tnguy22_ORDER.ORDER_NUM=tnguy22_ORDER_LINE.ORDER_NUM AND ORDER_DISCOUNT > 1;


SELECT tnguy22_PRODUCT.PROD_ID, ORDER_STATUS, NUM_ORDERED, (PROD_QUANTITY-NUM_ORDERED) AS 'WAREHOUSE' 
FROM tnguy22_PRODUCT, tnguy22_ORDER, tnguy22_ORDER_LINE WHERE tnguy22_ORDER.ORDER_NUM= tnguy22_ORDER_LINE.ORDER_NUM AND
tnguy22_PRODUCT.PROD_ID=tnguy22_ORDER_LINE.PROD_ID AND (NUM_ORDERED BETWEEN 2 AND 5) ORDER BY NUM_ORDERED;


SELECT DEP_FNAME FROM EMPLOYEE, DEPENDENT WHERE EMPLOYEE.EMP_ID=DEPENDENT.EMP_ID AND EMPLOYEE.EMP_ID IN(SELECT EMPLOYEE.EMP_ID FROM EMPLOYEE WHERE EMP_ID = 113123); 


SELECT tnguy22_PRODUCT.PROD_ID, PROD_QUANTITY FROM tnguy22_PRODUCT WHERE PROD_PRICE < 20.99 GROUP BY DESCRIPTION HAVING PROD_QUANTITY <>100;

THANH NGUYEN